{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/utils.js","webpack:///./js/ui.js","webpack:///./js/libs/Vector2D.js","webpack:///./js/libs/Ball.js","webpack:///./js/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","installedModules","0","installedWasmModules","wasmImportObjects","2","./ball_wasm","__wbg_sqrt_6ac1ec864938feb9","p0f64","exports","__wbg_random_918d3291fe65513c","__widl_f_begin_path_CanvasRenderingContext2D","p0i32","__widl_f_fill_CanvasRenderingContext2D","__widl_f_set_fill_style_CanvasRenderingContext2D","p1i32","__widl_f_arc_CanvasRenderingContext2D","p1f64","p2f64","p3f64","p4f64","p5f64","p6i32","__widl_f_close_path_CanvasRenderingContext2D","__widl_f_clear_rect_CanvasRenderingContext2D","__wbindgen_number_get","__wbindgen_string_get","__wbindgen_boolean_get","__wbindgen_is_null","__wbindgen_is_undefined","__wbindgen_is_symbol","__wbindgen_throw","__webpack_require__","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","head","document","getElementsByTagName","script","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","undefined","setTimeout","appendChild","1","forEach","wasmModuleId","installedWasmModuleData","importObject","req","fetch","WebAssembly","compileStreaming","all","then","items","instantiate","instantiateStreaming","x","arrayBuffer","bytes","res","w","instance","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","DEBOUNCE_RESIZE_CANVAS_MS","makeStage","_trackers","stage","width","innerWidth","height","innerHeight","track","tracker","debouncedResizeToWindow","fn","time","args","apply","this","debounce","addEventListener","cleanup","removeEventListener","prepareUI","rootNode","getElementById","infosNode","shuffleButton","innerText","shuffleWrapperNode","append","htmlRenderNode","div","className","style","position","top","left","zIndex","makeHtmlRenderNode","canvasRenderNode","canvas","makeCanvasRenderNode","renderModeToggles","modes","inputs","map","input","id","checked","onchange","getElementsByClassName","display","label","htmlFor","wrapper","ul","listStyle","paddingLeft","makeRenderModeToggle","canvasCtx","getContext","Vector2D","[object Object]","y","Math","sqrt","vector","get_length","scale","libs_Vector2D","libs_Ball","velocity_x","velocity_y","radius","mass","gravity","elasticity","friction","stage_width","stage_height","ball","xd","yd","sum_radius","delta","get_vector_2d","mtd","im1","im2","vector_velocity","normalized_mtd","normalize","vn","dot","impulse","ims1","ims2","random","BALL_RADIUS","BALL_MASS","BALL_GRAVITY","BALL_ELASTICITY","BALL_FRICTION","makeBall","velocityX","velocityY","wasm","Ball","updateBalls","balls","step","manageStageBorderCollision","j","checkBallCollision","resolveBallCollision","drawJsBallToCtx","ctx","color","fillStyle","beginPath","arc","PI","closePath","fill","drawJsBallToHtml","drawFunc","wasmCollection-compute-wasmCollection-render-canvas","drawToCtx","wasmCollection-compute-wasmCollection-render-html","innerHTML","drawToHtml","wasm-compute-wasm-render-canvas","clearRect","drawWasmBallToCtx","wasm-compute-wasm-render-html","drawWasmBallToHtml","join","wasm-compute-js-render-canvas","wasm-compute-js-render-html","js-compute-js-render-canvas","js-compute-js-render-html","lastFrameTimeMs","wasmCollection","BallCollection","Array","from","_","js","shuffle","setRandomPositionAndSpeedInBounds","log","format","onclick","loop","timestamp","requestAnimationFrame","split","update","toFixed","round","catch","pre","message","root"],"mappings":"aACA,SAAAA,EAAAC,GAQA,IAPA,IAMAC,EAAAC,EANAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GAKAK,EAAA,EAAAC,EAAA,GACQD,EAAAF,EAAAI,OAAoBF,IAC5BH,EAAAC,EAAAE,GACAG,EAAAN,IACAI,EAAAG,KAAAD,EAAAN,GAAA,IAEAM,EAAAN,GAAA,EAEA,IAAAD,KAAAG,EACAM,OAAAC,UAAAC,eAAAC,KAAAT,EAAAH,KACAa,EAAAb,GAAAG,EAAAH,IAKA,IAFAc,KAAAf,GAEAM,EAAAC,QACAD,EAAAU,OAAAV,GAOA,IAAAW,EAAA,GAKAT,EAAA,CACAU,EAAA,GAWA,IAAAC,EAAA,GAIA,IAAAC,EAAA,CACAC,EAAA,WACA,OACAC,cAAA,CACAC,4BAAA,SAAAC,GACA,OAAAP,EAAA,GAAAQ,QAAA,4BAAAD,IAEAE,8BAAA,WACA,OAAAT,EAAA,GAAAQ,QAAA,iCAEAE,6CAAA,SAAAC,GACA,OAAAX,EAAA,GAAAQ,QAAA,6CAAAG,IAEAC,uCAAA,SAAAD,GACA,OAAAX,EAAA,GAAAQ,QAAA,uCAAAG,IAEAE,iDAAA,SAAAF,EAAAG,GACA,OAAAd,EAAA,GAAAQ,QAAA,iDAAAG,EAAAG,IAEAC,sCAAA,SAAAJ,EAAAK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GACA,OAAArB,EAAA,GAAAQ,QAAA,sCAAAG,EAAAK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,IAEAC,6CAAA,SAAAX,GACA,OAAAX,EAAA,GAAAQ,QAAA,6CAAAG,IAEAY,6CAAA,SAAAZ,EAAAK,EAAAC,EAAAC,EAAAC,GACA,OAAAnB,EAAA,GAAAQ,QAAA,6CAAAG,EAAAK,EAAAC,EAAAC,EAAAC,IAEAK,sBAAA,SAAAb,EAAAG,GACA,OAAAd,EAAA,GAAAQ,QAAA,sBAAAG,EAAAG,IAEAW,sBAAA,SAAAd,EAAAG,GACA,OAAAd,EAAA,GAAAQ,QAAA,sBAAAG,EAAAG,IAEAY,uBAAA,SAAAf,GACA,OAAAX,EAAA,GAAAQ,QAAA,uBAAAG,IAEAgB,mBAAA,SAAAhB,GACA,OAAAX,EAAA,GAAAQ,QAAA,mBAAAG,IAEAiB,wBAAA,SAAAjB,GACA,OAAAX,EAAA,GAAAQ,QAAA,wBAAAG,IAEAkB,qBAAA,SAAAlB,GACA,OAAAX,EAAA,GAAAQ,QAAA,qBAAAG,IAEAmB,iBAAA,SAAAnB,EAAAG,GACA,OAAAd,EAAA,GAAAQ,QAAA,iBAAAG,EAAAG,QAQA,SAAAiB,EAAA/C,GAGA,GAAAgB,EAAAhB,GACA,OAAAgB,EAAAhB,GAAAwB,QAGA,IAAAwB,EAAAhC,EAAAhB,GAAA,CACAI,EAAAJ,EACAiD,GAAA,EACAzB,QAAA,IAUA,OANAX,EAAAb,GAAAY,KAAAoC,EAAAxB,QAAAwB,IAAAxB,QAAAuB,GAGAC,EAAAC,GAAA,EAGAD,EAAAxB,QAKAuB,EAAAG,EAAA,SAAAjD,GACA,IAAAkD,EAAA,GAKAC,EAAA7C,EAAAN,GACA,OAAAmD,EAGA,GAAAA,EACAD,EAAA3C,KAAA4C,EAAA,QACK,CAEL,IAAAC,EAAA,IAAAC,QAAA,SAAAC,EAAAC,GACAJ,EAAA7C,EAAAN,GAAA,CAAAsD,EAAAC,KAEAL,EAAA3C,KAAA4C,EAAA,GAAAC,GAGA,IAEAI,EAFAC,EAAAC,SAAAC,qBAAA,WACAC,EAAAF,SAAAG,cAAA,UAGAD,EAAAE,QAAA,QACAF,EAAAG,QAAA,IACAjB,EAAAkB,IACAJ,EAAAK,aAAA,QAAAnB,EAAAkB,IAEAJ,EAAAM,IAtHA,SAAAlE,GACA,OAAA8C,EAAAqB,EAAA,GAAAnE,EAAA,aAqHAoE,CAAApE,GAEAwD,EAAA,SAAAa,GAEAT,EAAAU,QAAAV,EAAAW,OAAA,KACAC,aAAAT,GACA,IAAAU,EAAAnE,EAAAN,GACA,OAAAyE,EAAA,CACA,GAAAA,EAAA,CACA,IAAAC,EAAAL,IAAA,SAAAA,EAAAM,KAAA,UAAAN,EAAAM,MACAC,EAAAP,KAAAQ,QAAAR,EAAAQ,OAAAX,IACAY,EAAA,IAAAC,MAAA,iBAAA/E,EAAA,cAAA0E,EAAA,KAAAE,EAAA,KACAE,EAAAH,KAAAD,EACAI,EAAAE,QAAAJ,EACAH,EAAA,GAAAK,GAEAxE,EAAAN,QAAAiF,IAGA,IAAAlB,EAAAmB,WAAA,WACA1B,EAAA,CAAwBmB,KAAA,UAAAE,OAAAjB,KAClB,MACNA,EAAAU,QAAAV,EAAAW,OAAAf,EACAC,EAAA0B,YAAAvB,GAmCA,OA7BA,CAAsBwB,EAAA,KAAQpF,IAAA,IAE9BqF,QAAA,SAAAC,GACA,IAAAC,EAAAtE,EAAAqE,GAGA,GAAAC,EACArC,EAAA3C,KAAAgF,OACA,CACA,IAEAnC,EAFAoC,EAAAtE,EAAAoE,KACAG,EAAAC,MAAA5C,EAAAqB,EAAA,IAAmDhD,EAAA,wBAA2BmE,GAAA,gBAE9E,GAAAE,aAAAnC,SAAA,mBAAAsC,YAAAC,iBACAxC,EAAAC,QAAAwC,IAAA,CAAAF,YAAAC,iBAAAH,GAAAD,IAAAM,KAAA,SAAAC,GACA,OAAAJ,YAAAK,YAAAD,EAAA,GAAAA,EAAA,WAEM,sBAAAJ,YAAAM,qBACN7C,EAAAuC,YAAAM,qBAAAR,EAAAD,OACM,CAENpC,EADAqC,EAAAK,KAAA,SAAAI,GAA+C,OAAAA,EAAAC,gBAC/CL,KAAA,SAAAM,GACA,OAAAT,YAAAK,YAAAI,EAAAZ,KAGAtC,EAAA3C,KAAAU,EAAAqE,GAAAlC,EAAA0C,KAAA,SAAAO,GACA,OAAAvD,EAAAwD,EAAAhB,IAAAe,EAAAE,UAAAF,GAAA9E,cAIA8B,QAAAwC,IAAA3C,IAIAJ,EAAA0D,EAAA5F,EAGAkC,EAAA2D,EAAA1F,EAGA+B,EAAA4D,EAAA,SAAAnF,EAAAoF,EAAAC,GACA9D,EAAA+D,EAAAtF,EAAAoF,IACAnG,OAAAsG,eAAAvF,EAAAoF,EAAA,CAA0CI,YAAA,EAAAC,IAAAJ,KAK1C9D,EAAAmE,EAAA,SAAA1F,GACA,oBAAA2F,eAAAC,aACA3G,OAAAsG,eAAAvF,EAAA2F,OAAAC,YAAA,CAAwDC,MAAA,WAExD5G,OAAAsG,eAAAvF,EAAA,cAAiD6F,OAAA,KAQjDtE,EAAAuE,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAtE,EAAAsE,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAhH,OAAAiH,OAAA,MAGA,GAFA3E,EAAAmE,EAAAO,GACAhH,OAAAsG,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAtE,EAAA4D,EAAAc,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIA1E,EAAA8E,EAAA,SAAA7E,GACA,IAAA6D,EAAA7D,KAAAwE,WACA,WAA2B,OAAAxE,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAD,EAAA4D,EAAAE,EAAA,IAAAA,GACAA,GAIA9D,EAAA+D,EAAA,SAAAgB,EAAAC,GAAsD,OAAAtH,OAAAC,UAAAC,eAAAC,KAAAkH,EAAAC,IAGtDhF,EAAAqB,EAAA,GAGArB,EAAAiF,GAAA,SAAAC,GAA8D,MAApBC,QAAAnD,MAAAkD,GAAoBA,GAG9DlF,EAAAwD,EAAA,GAEA,IAAA4B,EAAAC,OAAA,aAAAA,OAAA,iBACAC,EAAAF,EAAA3H,KAAAoH,KAAAO,GACAA,EAAA3H,KAAAV,EACAqI,IAAAG,QACA,QAAAlI,EAAA,EAAgBA,EAAA+H,EAAA7H,OAAuBF,IAAAN,EAAAqI,EAAA/H,IACvC,IAAAU,EAAAuH,EAIAtF,IAAAwF,EAAA,yCCjSA,MAAAC,EAAA,IAEO,SAAAC,IACP,MAAAC,EAAA,GACAC,EAAA,CACAC,MAAAR,OAAAS,WACAC,OAAAV,OAAAW,YACAxB,KAAA,gCAGAyB,MAAA,SAAAC,GACA,sBAAAA,EACA,UAAAjE,MACA,oFAGAiE,EAAAN,GACAD,EAAAlI,KAAAyI,KAEAC,EAgBA,SAAAC,EAAAC,GACA,IAAApF,EACA,mBAAAqF,GAEA5E,aAAAT,GACAA,EAAAmB,WAFA,IAAAgE,EAAAG,MAAAC,KAAAF,GAEAD,IArBAI,CAAA,KACAb,EAAAC,MAAAR,OAAAS,WACAF,EAAAG,OAAAV,OAAAW,YACAL,EAAApD,QAAA2D,IACAA,EAAAN,MAEGH,GAEH,OADAJ,OAAAqB,iBAAA,SAAAP,GAAA,GACA,CACAQ,QAAA,KACAtB,OAAAuB,oBAAA,SAAAT,IAEAP,SCkCO,SAAAiB,EAAAjB,GACP,MAAAkB,EAAAlG,SAAAmG,eAAA,QACAC,EAAApG,SAAAG,cAAA,KACAkG,EAAArG,SAAAG,cAAA,UACAkG,EAAAC,UAAA,UACA,MAAAC,EAAAvG,SAAAG,cAAA,KACAoG,EAAAC,OAAAH,GACA,MAAAI,EA7DA,WACA,MAAAC,EAAA1G,SAAAG,cAAA,OAOA,OANAuG,EAAAC,UACA,wIACAD,EAAAE,MAAAC,SAAA,WACAH,EAAAE,MAAAE,IAAA,MACAJ,EAAAE,MAAAG,KAAA,MACAL,EAAAE,MAAAI,QAAA,EACAN,EAqDAO,GACAC,EAzEA,WACA,MAAAC,EAAAnH,SAAAG,cAAA,UAOA,OANAgH,EAAAR,UACA,gJACAQ,EAAAP,MAAAC,SAAA,WACAM,EAAAP,MAAAE,IAAA,MACAK,EAAAP,MAAAG,KAAA,MACAI,EAAAP,MAAAI,QAAA,EACAG,EAiEAC,GACApC,EAAAK,MAAA,EAAgBJ,QAAAE,aAChB+B,EAAAjC,QACAiC,EAAA/B,WAEAH,EAAAK,MAAA,EAAgBJ,QAAAE,aAChBsB,EAAAG,MAAA3B,SAAoCA,MACpCwB,EAAAG,MAAAzB,UAAqCA,QAErC,MAAAkC,EAxDA,SAAAC,EAAA,GAAAtC,GACA,MAAAuC,EAAAD,EAAAE,IAAA5D,IACA,MAAA6D,EAAAzH,SAAAG,cAAA,SACAsH,EAAAxE,KAAA,cACAwE,EAAAxG,KAAA,QACAwG,EAAA/D,MAAAE,EAAAF,MACA+D,EAAAC,GAAA9D,EAAAF,MACA+D,EAAAE,QAAA3C,EAAApB,SAAAF,MACA+D,EAAAG,SAAArI,KAEA,IAAAS,SAAA6H,uBAAA7C,EAAApB,OAAAjC,QACApC,KAAAqH,MAAAkB,QAAA,QAEA9C,EAAApB,KAAArE,EAAA4B,OAAAuC,MAEA,IAAA1D,SAAA6H,uBAAA7C,EAAApB,OAAAjC,QACApC,KAAAqH,MAAAkB,QAAA,WAGA,MAAAC,EAAA/H,SAAAG,cAAA,SACA4H,EAAAzB,UAAA1C,EAAAmE,MACAA,EAAAC,QAAApE,EAAAF,MACA,MAAAuE,EAAAjI,SAAAG,cAAA,MAGA,OAFA8H,EAAAxG,YAAAgG,GACAQ,EAAAxG,YAAAsG,GACAE,IAEAC,EAAAlI,SAAAG,cAAA,MACAoH,EAAA5F,QAAA8F,GAAAS,EAAAzG,YAAAgG,IACAS,EAAAtB,MAAAuB,UAAA,OACAD,EAAAtB,MAAAwB,YAAA,OACA,MAAA3H,EAAAT,SAAAG,cAAA,KACAM,EAAA6F,UAAA,6DACA,MAAAI,EAAA1G,SAAAG,cAAA,OAGA,OAFAuG,EAAAjF,YAAAhB,GACAiG,EAAAjF,YAAAyG,GACAxB,EAoBA2B,CACA,CACA,CACA3E,MAAA,sDACAqE,MACA,oEAEA,CACArE,MAAA,oDACAqE,MAAA,kEAEA,CACArE,MAAA,kCACAqE,MACA,wEAEA,CACArE,MAAA,gCACAqE,MACA,sEAEA,CACArE,MAAA,gCACAqE,MAAA,8CAEA,CACArE,MAAA,8BACAqE,MAAA,4CAEA,CACArE,MAAA,8BACAqE,MAAA,4CAEA,CACArE,MAAA,4BACAqE,MAAA,2CAGA/C,GAQA,OANAkB,EAAAzE,YAAA4F,GACAnB,EAAAzE,YAAA2E,GACAF,EAAAzE,YAAA8E,GACAL,EAAAzE,YAAAyF,GACAhB,EAAAzE,YAAAgF,GAEA,CACAP,WACAE,YACAC,gBACAa,mBACAoB,UAAApB,EAAAqB,WAAA,MACA9B,kBCtIA,MAAA+B,EACAC,YAAAjG,EAAAkG,GACA9C,KAAApD,IACAoD,KAAA8C,IAEAD,aACA,OAAAE,KAAAC,KAAAhD,KAAApD,EAAAoD,KAAApD,EAAAoD,KAAA8C,EAAA9C,KAAA8C,GAEAD,IAAAI,GACA,OAAAjD,KAAApD,EAAAqG,EAAArG,EAAAoD,KAAA8C,EAAAG,EAAAH,EAEAD,YACA,WAAAD,EAAA5C,KAAApD,EAAAoD,KAAAkD,aAAAlD,KAAA8C,EAAA9C,KAAAkD,cAEAL,MAAAM,GACA,WAAAP,EAAA5C,KAAApD,EAAAuG,EAAAnD,KAAA8C,EAAAK,IAIe,IAAAC,EAAA,EC2GA,IAAAC,EAtHf,MACAR,YACAjG,EACAkG,EACAQ,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA5D,KAAApD,IACAoD,KAAA8C,IACA9C,KAAAsD,aACAtD,KAAAuD,aACAvD,KAAAwD,SACAxD,KAAAyD,OACAzD,KAAA0D,UACA1D,KAAA2D,aACA3D,KAAA4D,WAEAf,OACA7C,KAAApD,EAAAoD,KAAApD,EAAAoD,KAAA0D,QAAA1D,KAAAsD,WACAtD,KAAA8C,EAAA9C,KAAA8C,EAAA9C,KAAA0D,QAAA1D,KAAAuD,WACAvD,KAAAsD,WAAAtD,KAAA4D,SAAA5D,KAAAsD,WACAtD,KAAAuD,WAAAvD,KAAA4D,SAAA5D,KAAAuD,WAEAV,2BAAAgB,EAAAC,GAEA9D,KAAApD,EAAAoD,KAAAwD,OAAA,IACAxD,KAAAsD,YAAAtD,KAAAsD,WAAAtD,KAAA2D,WACA3D,KAAApD,EAAAoD,KAAAwD,QAGAxD,KAAApD,EAAAoD,KAAAwD,OAAAK,IACA7D,KAAAsD,YAAAtD,KAAAsD,WAAAtD,KAAA2D,WACA3D,KAAApD,EAAAiH,EAAA7D,KAAAwD,QAGAxD,KAAA8C,EAAA9C,KAAAwD,OAAA,IACAxD,KAAAuD,YAAAvD,KAAAuD,WAAAvD,KAAA2D,WACA3D,KAAA8C,EAAA9C,KAAAwD,QAGAxD,KAAA8C,EAAA9C,KAAAwD,OAAAM,IACA9D,KAAAuD,YAAAvD,KAAAuD,WAAAvD,KAAA2D,WACA3D,KAAA8C,EAAAgB,EAAA9D,KAAAwD,QAGAX,mBAAAkB,GACA,MAAAC,EAAAhE,KAAApD,EAAAmH,EAAAnH,EACAqH,EAAAjE,KAAA8C,EAAAiB,EAAAjB,EAEAoB,EAAAlE,KAAAwD,OAAAO,EAAAP,OAKA,OAFAQ,IAAAC,KAFAC,IASArB,qBAAAkB,GACA,MAGAI,EAAAnE,KAAAoE,cAAAL,GACA3G,EAAA+G,EAAAjB,aAEAmB,EAAAF,EAAAhB,OAAAnD,KAAAwD,OAAAO,EAAAP,OAAApG,MAIAkH,EAAA,EAAAtE,KAAAyD,KACAc,EAAA,EAAAR,EAAAN,KAGAe,EAAA,IAAgCpB,EAChCpD,KAAAsD,WAAAS,EAAAT,WACAtD,KAAAuD,WAAAQ,EAAAR,YAEAkB,EAAAJ,EAAAK,YACAC,EAAAH,EAAAI,IAAAH,GAGA,GAAAE,EAAA,EACA,OAIA,MAAA9N,GAAA,KAAA8N,GAAAL,EAAAC,GACAM,EAAAJ,EAAAtB,MAAAtM,GAGAiO,EAAAD,EAAA1B,MAAAmB,GACAS,EAAAF,EAAA1B,MAAAoB,GAEAvE,KAAAsD,YAAAtD,KAAAsD,WAAAwB,EAAAlI,GAAAoD,KAAA2D,WACA3D,KAAAuD,YAAAvD,KAAAuD,WAAAuB,EAAAhC,GAAA9C,KAAA2D,WACAI,EAAAT,YAAAS,EAAAT,WAAAyB,EAAAnI,GAAAoD,KAAA2D,WACAI,EAAAR,YAAAQ,EAAAR,WAAAwB,EAAAjC,GAAA9C,KAAA2D,WAEAd,kCAAAgB,EAAAC,GACA9D,KAAApD,EAAAoD,KAAAgF,SAAAnB,EACA7D,KAAA8C,EAAA9C,KAAAgF,SAAAlB,EACA9D,KAAAsD,WAAA,GAAAtD,KAAAgF,SACAhF,KAAAuD,WAAA,GAAAvD,KAAAgF,SAEAnC,cAAAkB,GACA,WAAeX,EAAQpD,KAAApD,EAAAmH,EAAAnH,EAAAoD,KAAA8C,EAAAiB,EAAAjB,GAEvBD,SACA,OAAAE,KAAAiC,WCtHA,MAAAC,EAAA,GACAC,EAAA,IACAC,EAAA,EACAC,EAAA,IACAC,EAAA,EAEA7L,EAAAG,EAAA,GAAA6C,KAAAhD,EAAA6E,KAAA,SACA7B,KAAA/C,IAKA,SAAA6L,GAAA1I,EACAA,EAAA,EAAAkG,EACAA,EAAA,EAAAyC,UACAA,EAAA,EAAAC,UACAA,EAAA,EAAAhC,OACAA,EAAAyB,EAAAxB,KACAA,EAAAyB,EAAAxB,QACAA,EAAAyB,EAAAxB,WACAA,EAAAyB,EAAAxB,SACAA,EAAAyB,EAAAI,KACAA,GAAA,GACK,IACL,WAAAA,EAAAhM,EAAAiM,KAAuCrC,GACvCzG,EACAkG,EACAyC,EACAC,EACAhC,EACAC,EACAC,EACAC,EACAC,GAIA,SAAA+B,EAAAC,GAEAA,EAAA7J,QAAAgI,KAAA8B,QAEAD,EAAA7J,QAAAgI,GACAA,EAAA+B,2BAAA1G,EAAAC,MAAAD,EAAAG,SAGA,QAAA1I,EAAA,EAAqBA,EAAA+O,EAAA7O,OAAkBF,IACvC,QAAAkP,EAAAlP,EAAA,EAA2BkP,EAAAH,EAAA7O,OAAkBgP,KAC7C,IAAAH,EAAA/O,GAAAmP,mBAAAJ,EAAAG,KACAH,EAAA/O,GAAAoP,qBAAAL,EAAAG,IA2BA,SAAAG,EAAAnC,EAAAoC,EAAAC,EAAA,WACAD,EAAAE,UAAAD,EACAD,EAAAG,YACAH,EAAAI,IAAAxC,EAAAnH,EAAAmH,EAAAjB,EAAAiB,EAAAP,OAAA,IAAAT,KAAAyD,IAAA,GACAL,EAAAM,YACAN,EAAAO,OAGA,SAAAC,EAAA5C,EAAAqC,EAAA,WACA,wDAA+DrC,EAAAjB,EAC/DiB,EAAAP,iBAA8BO,EAAAnH,EAC9BmH,EAAAP,uBAAoC4C,WACpC,EADmDrC,EAAAP,mBAC7B,EAAAO,EAAAP,0BACtBO,EAAAP,mBAIA,MAAAoD,EAAA,CACAC,sDAAA,WACAjB,EAAA,eAAAkB,UACApE,EACA,QACAtD,EAAAC,MACAD,EAAAG,SAGAwH,oDAAA,WACAlG,EAAAmG,UAAApB,EAAA,eAAAqB,WACA,aAGAC,kCAAA,WACAxE,EAAAyE,UAAA,IAAA/H,EAAAC,MAAAD,EAAAG,QACAqG,EAAA,KAAA7J,QAAAgI,GACAtK,EAAA2N,kBAAArD,EAAArB,EAAA,YAGA2E,gCAAA,WACAxG,EAAAmG,UAAApB,EAAA,KACAhE,IAAAmC,GAAAtK,EAAA6N,mBAAAvD,EAAA,UACAwD,KAAA,KAEAC,gCAAA,WACA9E,EAAAyE,UAAA,IAAA/H,EAAAC,MAAAD,EAAAG,QACAqG,EAAA,KAAA7J,QAAAgI,GAAAmC,EAAAnC,EAAArB,EAAA,UAEA+E,8BAAA,WACA5G,EAAAmG,UAAApB,EAAA,KACAhE,IAAAmC,GAAA4C,EAAA5C,EAAA,aACAwD,KAAA,KAEAG,8BAAA,WACAhF,EAAAyE,UAAA,IAAA/H,EAAAC,MAAAD,EAAAG,QACAqG,EAAA,GAAA7J,QAAAgI,GAAAmC,EAAAnC,EAAArB,EAAA,SAEAiF,4BAAA,WACA9G,EAAAmG,UAAApB,EAAA,GACAhE,IAAAmC,GAAA4C,EAAA5C,EAAA,YACAwD,KAAA,MA2BA,MAEAnI,MAAWA,GAAWF,KACtBsB,UAAWA,EAAAkC,YAAA7B,iBAAAJ,iBAAyDJ,EACpEjB,GAGA,IAAA+E,EAAA,EACAyD,EAAA,EAEA,MAAAhC,EAAA,CACAiC,eAAA,MACA,MAAAjC,EAAA,IAAAnM,EAAAqO,eASA,OARAlC,EAAAc,KAbA,GAeAzB,EACAC,EACAC,EACAC,EACAC,GAEAO,GAVA,GAYAH,KAAAsC,MAAAC,KAAAD,MAvBA,IAuBAE,GAAA3C,KACA4C,GAAAH,MAAAC,KAAAD,MAxBA,IAwBAE,GAAA3C,EAAA,CAAsDG,MAAA,MAGtD0C,EAAA,KACAvC,EAAA,eAAAwC,kCACAhJ,EAAAC,MACAD,EAAAG,QAEAZ,QAAA0J,IAAAzC,EAAA,eAAA0C,UACA1C,EAAA,KAAA7J,QAAAgI,IACAA,EAAAqE,kCAAAhJ,EAAAC,MAAAD,EAAAG,UAEAqG,EAAA,GAAA7J,QAAAgI,IACAA,EAAAqE,kCAAAhJ,EAAAC,MAAAD,EAAAG,WAIAkB,EAAA8H,QAAAJ,EAEAA,IApDA,SAAAK,EAAAC,GACAC,sBAAAF,GA/FA,SAAApL,GAEA,OADA+G,EAAA/G,EACAgC,EAAApB,KAAA2K,MAAA,KAAAnR,SACA,qBACAoO,EAAA,eAAAgD,OAAAxJ,EAAAC,MAAAD,EAAAG,QACA,MACA,WACAoG,EAAAC,EAAA,MACA,MACA,SACAD,EAAAC,EAAA,KAsFAgD,CAAAH,EAAAb,GAZApH,EAAAE,oBAAsCyD,EAAA0E,QACtC,qBAC0B9F,KAAA+F,MAAA,IAAA3E,SAE1ByC,EAAAxH,EAAApB,QAUA4J,EAAAa,EAiDAD,KAEAO,MAAAvN,IACA,MAAAX,EAAAT,SAAAG,cAAA,KACAM,EAAA6F,UAAA,oBACA,MAAAsI,EAAA5O,SAAAG,cAAA,OACAyO,EAAAtI,UAAAlF,EAAAyN,QACA,MAAAC,EAAA9O,SAAAmG,eAAA,QACA2I,EAAArN,YAAAhB,GACAqO,EAAArN,YAAAmN","file":"bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + chunkId + \".bundle.js\"\n \t}\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \tfunction promiseResolve() { return Promise.resolve(); }\n\n \tvar wasmImportObjects = {\n \t\t2: function() {\n \t\t\treturn {\n \t\t\t\t\"./ball_wasm\": {\n \t\t\t\t\t\"__wbg_sqrt_6ac1ec864938feb9\": function(p0f64) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbg_sqrt_6ac1ec864938feb9\"](p0f64);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbg_random_918d3291fe65513c\": function() {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbg_random_918d3291fe65513c\"]();\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_begin_path_CanvasRenderingContext2D\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_begin_path_CanvasRenderingContext2D\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_fill_CanvasRenderingContext2D\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_fill_CanvasRenderingContext2D\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_set_fill_style_CanvasRenderingContext2D\": function(p0i32,p1i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_set_fill_style_CanvasRenderingContext2D\"](p0i32,p1i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_arc_CanvasRenderingContext2D\": function(p0i32,p1f64,p2f64,p3f64,p4f64,p5f64,p6i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_arc_CanvasRenderingContext2D\"](p0i32,p1f64,p2f64,p3f64,p4f64,p5f64,p6i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_close_path_CanvasRenderingContext2D\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_close_path_CanvasRenderingContext2D\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__widl_f_clear_rect_CanvasRenderingContext2D\": function(p0i32,p1f64,p2f64,p3f64,p4f64) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__widl_f_clear_rect_CanvasRenderingContext2D\"](p0i32,p1f64,p2f64,p3f64,p4f64);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_number_get\": function(p0i32,p1i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_number_get\"](p0i32,p1i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_string_get\": function(p0i32,p1i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_string_get\"](p0i32,p1i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_boolean_get\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_boolean_get\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_is_null\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_is_null\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_is_undefined\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_is_undefined\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_is_symbol\": function(p0i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_is_symbol\"](p0i32);\n \t\t\t\t\t},\n \t\t\t\t\t\"__wbindgen_throw\": function(p0i32,p1i32) {\n \t\t\t\t\t\treturn installedModules[1].exports[\"__wbindgen_throw\"](p0i32,p1i32);\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t};\n \t\t},\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar head = document.getElementsByTagName('head')[0];\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\thead.appendChild(script);\n \t\t\t}\n \t\t}\n\n \t\t// Fetch + compile chunk loading for webassembly\n\n \t\tvar wasmModules = {\"1\":[2]}[chunkId] || [];\n\n \t\twasmModules.forEach(function(wasmModuleId) {\n \t\t\tvar installedWasmModuleData = installedWasmModules[wasmModuleId];\n\n \t\t\t// a Promise means \"currently loading\" or \"already loaded\".\n \t\t\tif(installedWasmModuleData)\n \t\t\t\tpromises.push(installedWasmModuleData);\n \t\t\telse {\n \t\t\t\tvar importObject = wasmImportObjects[wasmModuleId]();\n \t\t\t\tvar req = fetch(__webpack_require__.p + \"\" + {\"2\":\"4a8755734d1624b5f8d7\"}[wasmModuleId] + \".module.wasm\");\n \t\t\t\tvar promise;\n \t\t\t\tif(importObject instanceof Promise && typeof WebAssembly.compileStreaming === 'function') {\n \t\t\t\t\tpromise = Promise.all([WebAssembly.compileStreaming(req), importObject]).then(function(items) {\n \t\t\t\t\t\treturn WebAssembly.instantiate(items[0], items[1]);\n \t\t\t\t\t});\n \t\t\t\t} else if(typeof WebAssembly.instantiateStreaming === 'function') {\n \t\t\t\t\tpromise = WebAssembly.instantiateStreaming(req, importObject);\n \t\t\t\t} else {\n \t\t\t\t\tvar bytesPromise = req.then(function(x) { return x.arrayBuffer(); });\n \t\t\t\t\tpromise = bytesPromise.then(function(bytes) {\n \t\t\t\t\t\treturn WebAssembly.instantiate(bytes, importObject);\n \t\t\t\t\t});\n \t\t\t\t}\n \t\t\t\tpromises.push(installedWasmModules[wasmModuleId] = promise.then(function(res) {\n \t\t\t\t\treturn __webpack_require__.w[wasmModuleId] = (res.instance || res).exports;\n \t\t\t\t}));\n \t\t\t}\n \t\t});\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \t// object with all WebAssembly.instance exports\n \t__webpack_require__.w = {};\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const DEBOUNCE_RESIZE_CANVAS_MS = 300;\n\nexport function makeStage() {\n  const _trackers = [];\n  const stage = {\n    width: window.innerWidth,\n    height: window.innerHeight,\n    mode: \"wasm-compute-js-render-canvas\" // default mode\n  };\n  // track dom elements like canvas, div ... that will automatically be resized\n  stage.track = function(tracker) {\n    if (typeof tracker !== \"function\") {\n      throw new Error(\n        \"Must be a function that will be called on window resize to update width / height\"\n      );\n    }\n    tracker(stage);\n    _trackers.push(tracker);\n  };\n  const debouncedResizeToWindow = debounce(() => {\n    stage.width = window.innerWidth;\n    stage.height = window.innerHeight;\n    _trackers.forEach(tracker => {\n      tracker(stage);\n    });\n  }, DEBOUNCE_RESIZE_CANVAS_MS);\n  window.addEventListener(\"resize\", debouncedResizeToWindow, false);\n  return {\n    cleanup: () => {\n      window.removeEventListener(\"resize\", debouncedResizeToWindow);\n    },\n    stage\n  };\n}\n\nfunction debounce(fn, time) {\n  let timeout;\n  return function(...args) {\n    const functionCall = () => fn.apply(this, args);\n    clearTimeout(timeout);\n    timeout = setTimeout(functionCall, time);\n  };\n}\n","function makeCanvasRenderNode() {\n  const canvas = document.createElement(\"canvas\");\n  canvas.className =\n    \"wasmCollection-compute-wasmCollection-render-canvas wasm-compute-wasm-render-canvas wasm-compute-js-render-canvas js-compute-js-render-canvas\";\n  canvas.style.position = \"absolute\";\n  canvas.style.top = \"0px\";\n  canvas.style.left = \"0px\";\n  canvas.style.zIndex = -1;\n  return canvas;\n}\n\nfunction makeHtmlRenderNode() {\n  const div = document.createElement(\"div\");\n  div.className =\n    \"wasmCollection-compute-wasmCollection-render-html wasm-compute-wasm-render-html wasm-compute-js-render-html js-compute-js-render-html\";\n  div.style.position = \"absolute\";\n  div.style.top = \"0px\";\n  div.style.left = \"0px\";\n  div.style.zIndex = -1;\n  return div;\n}\n\n/**\n * Creates the radio buttons for render modes\n * and binds it to stage.mode\n */\nfunction makeRenderModeToggle(modes = [], stage) {\n  const inputs = modes.map(mode => {\n    const input = document.createElement(\"input\");\n    input.name = \"render-mode\";\n    input.type = \"radio\";\n    input.value = mode.value;\n    input.id = mode.value;\n    input.checked = stage.mode === mode.value;\n    input.onchange = e => {\n      // hide previous active layer\n      [...document.getElementsByClassName(stage.mode)].forEach(\n        e => (e.style.display = \"none\")\n      );\n      stage.mode = e.target.value;\n      // show current active layer\n      [...document.getElementsByClassName(stage.mode)].forEach(\n        e => (e.style.display = \"block\")\n      );\n    };\n    const label = document.createElement(\"label\");\n    label.innerText = mode.label;\n    label.htmlFor = mode.value;\n    const wrapper = document.createElement(\"li\");\n    wrapper.appendChild(input);\n    wrapper.appendChild(label);\n    return wrapper;\n  });\n  const ul = document.createElement(\"ul\");\n  inputs.forEach(input => ul.appendChild(input));\n  ul.style.listStyle = \"none\";\n  ul.style.paddingLeft = \"20px\";\n  const p = document.createElement(\"p\");\n  p.innerText = \"Choose an implementation between JavaScript and Rust/WASM:\";\n  const div = document.createElement(\"div\");\n  div.appendChild(p);\n  div.appendChild(ul);\n  return div;\n}\n\nexport function prepareUI(stage) {\n  const rootNode = document.getElementById(\"root\");\n  const infosNode = document.createElement(\"p\");\n  const shuffleButton = document.createElement(\"button\");\n  shuffleButton.innerText = \"SHUFFLE\";\n  const shuffleWrapperNode = document.createElement(\"p\");\n  shuffleWrapperNode.append(shuffleButton);\n  const htmlRenderNode = makeHtmlRenderNode();\n  const canvasRenderNode = makeCanvasRenderNode();\n  stage.track(({ width, height }) => {\n    canvasRenderNode.width = width;\n    canvasRenderNode.height = height;\n  });\n  stage.track(({ width, height }) => {\n    htmlRenderNode.style.width = `${width}px`;\n    htmlRenderNode.style.height = `${height}px`;\n  });\n  const renderModeToggles = makeRenderModeToggle(\n    [\n      {\n        value: \"wasmCollection-compute-wasmCollection-render-canvas\",\n        label:\n          \"compute by WASM - render by WASM into canvas (iteration in WASM)\"\n      },\n      {\n        value: \"wasmCollection-compute-wasmCollection-render-html\",\n        label: \"compute by WASM - render by WASM into html (iteration in WASM)\"\n      },\n      {\n        value: \"wasm-compute-wasm-render-canvas\",\n        label:\n          \"compute by WASM - render by WASM into canvas (iteration still in JS)\"\n      },\n      {\n        value: \"wasm-compute-wasm-render-html\",\n        label:\n          \"compute by WASM - render by WASM into html (iteration still in JS)\"\n      },\n      {\n        value: \"wasm-compute-js-render-canvas\",\n        label: \"compute by WASM - render by JS into canvas\"\n      },\n      {\n        value: \"wasm-compute-js-render-html\",\n        label: \"compute by WASM - render by JS into html\"\n      },\n      {\n        value: \"js-compute-js-render-canvas\",\n        label: \"compute by JS - render by JS into canvas\"\n      },\n      {\n        value: \"js-compute-js-render-html\",\n        label: \"compute by JS - render by JS into html\"\n      }\n    ],\n    stage\n  );\n  rootNode.appendChild(renderModeToggles);\n  rootNode.appendChild(infosNode);\n  rootNode.appendChild(shuffleWrapperNode);\n  rootNode.appendChild(canvasRenderNode);\n  rootNode.appendChild(htmlRenderNode);\n\n  return {\n    rootNode,\n    infosNode,\n    shuffleButton,\n    canvasRenderNode,\n    canvasCtx: canvasRenderNode.getContext(\"2d\"),\n    htmlRenderNode\n  };\n}\n","class Vector2D {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n  get_length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n  dot(vector) {\n    return this.x * vector.x + this.y * vector.y;\n  }\n  normalize() {\n    return new Vector2D(this.x / this.get_length(), this.y / this.get_length());\n  }\n  scale(scale) {\n    return new Vector2D(this.x * scale, this.y * scale);\n  }\n}\n\nexport default Vector2D;\n","/**\n * Basic JS reimplementation of https://github.com/topheman/Ball.js\n *\n * Same exact implementation as the Rust/Wasm one in the ./crate folder\n */\n\nimport Vector2D from \"./Vector2D\";\n\nclass Ball {\n  constructor(\n    x,\n    y,\n    velocity_x,\n    velocity_y,\n    radius,\n    mass,\n    gravity,\n    elasticity,\n    friction\n  ) {\n    this.x = x;\n    this.y = y;\n    this.velocity_x = velocity_x;\n    this.velocity_y = velocity_y;\n    this.radius = radius;\n    this.mass = mass;\n    this.gravity = gravity;\n    this.elasticity = elasticity;\n    this.friction = friction;\n  }\n  step() {\n    this.x = this.x + this.gravity * this.velocity_x;\n    this.y = this.y + this.gravity * this.velocity_y;\n    this.velocity_x = this.friction * this.velocity_x;\n    this.velocity_y = this.friction * this.velocity_y;\n  }\n  manageStageBorderCollision(stage_width, stage_height) {\n    // left border\n    if (this.x - this.radius < 0.0) {\n      this.velocity_x = -this.velocity_x * this.elasticity;\n      this.x = this.radius;\n    }\n    // right border\n    if (this.x + this.radius > stage_width) {\n      this.velocity_x = -this.velocity_x * this.elasticity;\n      this.x = stage_width - this.radius;\n    }\n    // top border\n    if (this.y - this.radius < 0.0) {\n      this.velocity_y = -this.velocity_y * this.elasticity;\n      this.y = this.radius;\n    }\n    // bottom border\n    if (this.y + this.radius > stage_height) {\n      this.velocity_y = -this.velocity_y * this.elasticity;\n      this.y = stage_height - this.radius;\n    }\n  }\n  checkBallCollision(ball) {\n    const xd = this.x - ball.x;\n    const yd = this.y - ball.y;\n\n    const sum_radius = this.radius + ball.radius;\n    const sqr_radius = sum_radius * sum_radius;\n\n    const dist_sqr = xd * xd + yd * yd;\n\n    if (dist_sqr <= sqr_radius) {\n      return true;\n    }\n    return false;\n  }\n  resolveBallCollision(ball) {\n    const RESTITUTION = 0.85;\n\n    //get the mtd\n    const delta = this.get_vector_2d(ball);\n    const d = delta.get_length();\n    // minimum translation distance to push balls apart after intersecting\n    const mtd = delta.scale((this.radius + ball.radius - d) / d);\n\n    // resolve intersection --\n    // inverse mass quantities\n    const im1 = 1 / this.mass;\n    const im2 = 1 / ball.mass;\n\n    // impact speed\n    const vector_velocity = new Vector2D(\n      this.velocity_x - ball.velocity_x,\n      this.velocity_y - ball.velocity_y\n    );\n    const normalized_mtd = mtd.normalize();\n    const vn = vector_velocity.dot(normalized_mtd);\n\n    // sphere intersecting but moving away from each other already\n    if (vn > 0.0) {\n      return;\n    }\n\n    // collision impulse\n    const i = (-(1.0 + RESTITUTION) * vn) / (im1 + im2);\n    const impulse = normalized_mtd.scale(i);\n\n    // change in momentum\n    const ims1 = impulse.scale(im1);\n    const ims2 = impulse.scale(im2);\n\n    this.velocity_x = (this.velocity_x + ims1.x) * this.elasticity;\n    this.velocity_y = (this.velocity_y + ims1.y) * this.elasticity;\n    ball.velocity_x = (ball.velocity_x - ims2.x) * this.elasticity;\n    ball.velocity_y = (ball.velocity_y - ims2.y) * this.elasticity;\n  }\n  setRandomPositionAndSpeedInBounds(stage_width, stage_height) {\n    this.x = this.random() * stage_width;\n    this.y = this.random() * stage_height;\n    this.velocity_x = this.random() * 10;\n    this.velocity_y = this.random() * 10;\n  }\n  get_vector_2d(ball) {\n    return new Vector2D(this.x - ball.x, this.y - ball.y);\n  }\n  random() {\n    return Math.random();\n  }\n}\n\nexport default Ball;\n","import { makeStage } from \"./utils\";\nimport { prepareUI } from \"./ui\";\nimport BallJS from \"./libs/Ball\";\n\nconst BALL_RADIUS = 15;\nconst BALL_MASS = 1.3;\nconst BALL_GRAVITY = 1;\nconst BALL_ELASTICITY = 0.98;\nconst BALL_FRICTION = 1;\n\nimport(\"../crate/pkg\")\n  .then(module => {\n    /**\n     * Factory that will return either the original JavaScript version or the WebAssembly one\n     * Specify a `wasm` boolean as an attribute to choose either version\n     */\n    function makeBall({\n      x = 0,\n      y = 0,\n      velocityX = 0,\n      velocityY = 0,\n      radius = BALL_RADIUS,\n      mass = BALL_MASS,\n      gravity = BALL_GRAVITY,\n      elasticity = BALL_ELASTICITY,\n      friction = BALL_FRICTION,\n      wasm = true\n    } = {}) {\n      return new (wasm ? module.Ball : BallJS)(\n        x,\n        y,\n        velocityX,\n        velocityY,\n        radius,\n        mass,\n        gravity,\n        elasticity,\n        friction\n      );\n    }\n\n    function updateBalls(balls) {\n      // move balls\n      balls.forEach(ball => ball.step());\n      // check balls vs border collision\n      balls.forEach(ball =>\n        ball.manageStageBorderCollision(stage.width, stage.height)\n      );\n      // check ball vs ball collision\n      for (let i = 0; i < balls.length; i++) {\n        for (let j = i + 1; j < balls.length; j++) {\n          if (balls[i].checkBallCollision(balls[j]) === true) {\n            balls[i].resolveBallCollision(balls[j]);\n          }\n        }\n      }\n    }\n\n    /**\n     * Update balls states\n     */\n    function update(d) {\n      delta = d;\n      switch (stage.mode.split(\"-\").shift()) {\n        case \"wasmCollection\":\n          balls[\"wasmCollection\"].update(stage.width, stage.height);\n          break;\n        case \"wasm\":\n          updateBalls(balls[\"wasm\"]);\n          break;\n        case \"js\":\n          updateBalls(balls[\"js\"]);\n          break;\n      }\n    }\n\n    /**\n     * Helper to draw a ball directly with JavaScript code\n     */\n    function drawJsBallToCtx(ball, ctx, color = \"#900000\") {\n      ctx.fillStyle = color;\n      ctx.beginPath();\n      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2, true);\n      ctx.closePath();\n      ctx.fill();\n    }\n\n    function drawJsBallToHtml(ball, color = \"#900000\") {\n      return `<div class=\"ball\" style=\"position:absolute;top:${ball.y -\n        ball.radius}px;left:${ball.x -\n        ball.radius}px;background:${color};width:${ball.radius *\n        2}px;height:${ball.radius * 2}px;border-radius:${\n        ball.radius\n      }px\"></div>`;\n    }\n\n    const drawFunc = {\n      \"wasmCollection-compute-wasmCollection-render-canvas\": function() {\n        balls[\"wasmCollection\"].drawToCtx(\n          canvasCtx,\n          \"black\",\n          stage.width,\n          stage.height\n        );\n      },\n      \"wasmCollection-compute-wasmCollection-render-html\": function() {\n        htmlRenderNode.innerHTML = balls[\"wasmCollection\"].drawToHtml(\n          \"darkgrey\"\n        );\n      },\n      \"wasm-compute-wasm-render-canvas\": function() {\n        canvasCtx.clearRect(0, 0, stage.width, stage.height);\n        balls[\"wasm\"].forEach(ball =>\n          module.drawWasmBallToCtx(ball, canvasCtx, \"purple\")\n        );\n      },\n      \"wasm-compute-wasm-render-html\": function() {\n        htmlRenderNode.innerHTML = balls[\"wasm\"]\n          .map(ball => module.drawWasmBallToHtml(ball, \"green\"))\n          .join(\"\");\n      },\n      \"wasm-compute-js-render-canvas\": function() {\n        canvasCtx.clearRect(0, 0, stage.width, stage.height);\n        balls[\"wasm\"].forEach(ball => drawJsBallToCtx(ball, canvasCtx, \"blue\"));\n      },\n      \"wasm-compute-js-render-html\": function() {\n        htmlRenderNode.innerHTML = balls[\"wasm\"]\n          .map(ball => drawJsBallToHtml(ball, \"darkblue\"))\n          .join(\"\");\n      },\n      \"js-compute-js-render-canvas\": function() {\n        canvasCtx.clearRect(0, 0, stage.width, stage.height);\n        balls[\"js\"].forEach(ball => drawJsBallToCtx(ball, canvasCtx, \"red\"));\n      },\n      \"js-compute-js-render-html\": function() {\n        htmlRenderNode.innerHTML = balls[\"js\"]\n          .map(ball => drawJsBallToHtml(ball, \"darkred\"))\n          .join(\"\");\n      }\n    };\n\n    /**\n     * Draw balls\n     */\n    function draw() {\n      infosNode.innerText = `Delta: ${delta.toFixed(\n        4\n      )}ms - FrameRate: ${Math.round(1000 / delta)} FPS`;\n      // draw balls in selected mode\n      drawFunc[stage.mode]();\n    }\n\n    /**\n     * Game loop\n     */\n    function loop(timestamp) {\n      requestAnimationFrame(loop);\n      update(timestamp - lastFrameTimeMs);\n      draw();\n      lastFrameTimeMs = timestamp;\n    }\n\n    // Execution\n\n    const MAX_BALLS = 10;\n\n    const { stage } = makeStage();\n    const { infosNode, canvasCtx, htmlRenderNode, shuffleButton } = prepareUI(\n      stage\n    );\n\n    let delta = 0;\n    let lastFrameTimeMs = 0;\n\n    const balls = {\n      wasmCollection: (() => {\n        const balls = new module.BallCollection();\n        balls.fill(\n          MAX_BALLS,\n          BALL_RADIUS,\n          BALL_MASS,\n          BALL_GRAVITY,\n          BALL_ELASTICITY,\n          BALL_FRICTION\n        );\n        return balls;\n      })(),\n      wasm: Array.from(Array(MAX_BALLS), _ => makeBall()),\n      js: Array.from(Array(MAX_BALLS), _ => makeBall({ wasm: false }))\n    };\n\n    const shuffle = () => {\n      balls[\"wasmCollection\"].setRandomPositionAndSpeedInBounds(\n        stage.width,\n        stage.height\n      );\n      console.log(balls[\"wasmCollection\"].format());\n      balls[\"wasm\"].forEach(ball => {\n        ball.setRandomPositionAndSpeedInBounds(stage.width, stage.height);\n      });\n      balls[\"js\"].forEach(ball => {\n        ball.setRandomPositionAndSpeedInBounds(stage.width, stage.height);\n      });\n    };\n\n    shuffleButton.onclick = shuffle;\n\n    shuffle();\n    loop();\n  })\n  .catch(error => {\n    const p = document.createElement(\"p\");\n    p.innerText = \"An error occured:\";\n    const pre = document.createElement(\"pre\");\n    pre.innerText = error.message;\n    const root = document.getElementById(\"root\");\n    root.appendChild(p);\n    root.appendChild(pre);\n  });\n"],"sourceRoot":""}